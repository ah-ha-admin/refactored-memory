jobs:
  my_first_job:
    steps:
      - name: Check out repository
        uses: actions/checkout@v3
        with:
          repository: Ah-ha-admin/refactored-memory
          ref: v1.0
          token: ${{ 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 }}
          path: ./.github/actions/refactored-memory
      - name: Run my action
        uses: ./.github/actions/workflows/jobs
Run actions/deploy-pages@v1
Actor: ah-ha-admin
Run actions/checkout@v3
Name: docker
Action ID: 3610059348
Artifact URL: https://pipelines.actions.githubusercontent.com/4KXsrVU1mUOKs7pos5Bk6Fq09D6jySVjT3cpPMvrTyCLYNX7nf/_apis/pipelines/workflows/3610059348/artifacts?api-version=6.0-preview
{"count":1,"value":[{"containerId":1385265,"size":102400,"signedContent":null,"fileContainerResourceUrl":"https://pipelines.actions.githubusercontent.com/4KXsrVU1mUOKs7pos5Bk6Fq09D6jySVjT3cpPMvrTyCLYNX7nf/_apis/resources/Containers/1385265","type":"actions_storage","name":"github-pages","url":"https://pipelines.actions.githubusercontent.com/4KXsrVU1mUOKs7pos5Bk6Fq09D6jySVjT3cpPMvrTyCLYNX7nf/_apis/pipelines/1/runs/1832/artifacts?artifactName=github-pages","expiresOn":"2022-12-04T20:12:07.8712362Z","items":null}]}
Creating deployment with payload:
{
	"artifact_url": "https://pipelines.actions.githubusercontent.com/4KXsrVU1mUOKs7pos5Bk6Fq09D6jySVjT3cpPMvrTyCLYNX7nf/_apis/pipelines/1/runs/1832/artifacts?artifactName=github-pages&%24expand=SignedContent",
	"pages_build_version": "d844251c0b0442681cc87b49a1acb46f9109b099",
	"oidc_token": "***"
}
Created deployment for d844251c0b0442681cc87b49a1acb46f9109b099
{"page_url":"https://ah-ha-admin.github.io/refactored-memory/","status_url":"https://api.github.com/repos/ah-ha-admin/refactored-memory/pages/deployment/status/d844251c0b0442681cc87b49a1acb46f9109b099","preview_url":""}
Reported success!

Run actions/workflows@v3
runs-on: action/checkout@v3
  on: pull request,draft,commit,comment,push
on:
  push:
      branches:
            - master

            jobs:
              publish-components:
                  name: Publish Marketplace Content to Pipedream
                      runs-on: ubuntu-latest
                          steps:
                                - name: Checkout code
                                        uses: actions/checkout@v3.2.0
                                              - uses: pnpm/action-setup@v2.2.4
                                                      with:
                                                                version: 7.0.0
                                                                      - name: Get pnpm store directory
                                                                              id: pnpm-cache
                                                                                      run: |
                                                                                                echo "::set-output name=pnpm_cache_dir::$(pnpm store path)"
                                                                                                      - uses: actions/cache@v3
                                                                                                              name: Setup pnpm cache
                                                                                                                      with:
                                                                                                                                path: ${{ steps.pnpm-cache.outputs.pnpm_cache_dir }}
                                                                                                                                          key: ${{ runner.os }}-pnpm-store-${{ hashFiles('**/pnpm-lock.yaml') }}
                                                                                                                                                    restore-keys: |
                                                                                                                                                                ${{ runner.os }}-pnpm-store-
                                                                                                                                                                      - name: Install dependencies
                                                                                                                                                                              run: pnpm install -r --no-frozen-lockfile
                                                                                                                                                                                    - name: Setup Node Env
                                                                                                                                                                                            uses: actions/setup-node@v3.5.1
                                                                                                                                                                                                    with:
                                                                                                                                                                                                              node-version: 14
                                                                                                                                                                                                                        registry-url: https://registry.npmjs.org/
                                                                                                                                                                                                                                  cache: 'pnpm'
                                                                                                                                                                                                                                        - name: Get Changed Files
                                                                                                                                                                                                                                                id: files
                                                                                                                                                                                                                                                        uses: jitterbit/get-changed-files@v1
                                                                                                                                                                                                                                                                with:
                                                                                                                                                                                                                                                                          format: 'csv'
                                                                                                                                                                                                                                                                                - name: Publish changes to marketplace content
                                                                                                                                                                                                                                                                                        id: publish
                                                                                                                                                                                                                                                                                                env:
                                                                                                                                                                                                                                                                                                          PD_API_KEY: ${{ secrets.PD_API_KEY }}
                                                                                                                                                                                                                                                                                                                    ENDPOINT: ${{ secrets.ENDPOINT }}
                                                                                                                                                                                                                                                                                                                            shell: bash {0} # don't fast fail
                                                                                                                                                                                                                                                                                                                                    run: |
                                                                                                                                                                                                                                                                                                                                              printf -v added_modified_renamed_files '%s,%s' '${{ steps.files.outputs.added_modified }}' '${{ steps.files.outputs.renamed }}'
                                                                                                                                                                                                                                                                                                                                                        pnpm dlx ts-node --esm scripts/updateMarketplaceReadme.mts $added_modified_renamed_files
																																	
																																	defineComponent({
  async run({ steps, $ }) {
    await $.respond({
      status: 200,
      headers: { "API-KEY": "PROCESS.ENV" },
      body: { message: "process.env" }, // This can be any string, object, Buffer, or Readable stream
    });
  }
});
